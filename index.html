<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ひらがな入力アプリ</title>

<style>
/* ===== 画面いっぱいにする ===== */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
}

body {
  font-family: sans-serif;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

/* ===== 五十音表 ===== */
.table {
  display: grid;
  grid-template-rows: repeat(5, 1fr); /* あいうえお */
  grid-auto-flow: column;
  gap: 8px;
  flex: 1;               /* 画面の残り全部使う */
  padding: 8px;
}

button {
  width: 100%;
  height: 100%;
  font-size: 28px;
  padding: 8px;
  cursor: pointer;
  touch-action: manipulation;
}

.empty {
  visibility: hidden;
}

/* ===== 入力結果（横書き） ===== */
#result {
  font-size: 36px;
  min-height: 64px;
  padding: 12px;
  border-top: 2px solid #ccc;
  writing-mode: horizontal-tb;
  white-space: pre-wrap;
}

/* ===== 操作ボタン ===== */
.controls {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
  gap: 6px;
  padding: 6px;
}

/* ===== スマホ特化 ===== */
@media (max-width: 600px) {
  button {
    font-size: 36px;
  }

  #result {
    font-size: 48px;
  }
}
</style>
</head>

<body>

<div class="table" id="gojuon"></div>

<div id="result"></div>

<div class="controls">
  <button id="del">⌫</button>
  <button id="clear">全消し</button>
  <button data-char="゛">゛</button>
  <button data-char="゜">゜</button>
  <button data-char="ゃ">ゃ</button>
  <button data-char="ゅ">ゅ</button>
  <button data-char="ょ">ょ</button>
  <button data-char="っ">っ</button>
  <button data-char="ぁ">ぁ</button>
  <button data-char="ぃ">ぃ</button>
  <button data-char="ぅ">ぅ</button>
  <button data-char="ぇ">ぇ</button>
  <button data-char="ぉ">ぉ</button>
</div>

<script>
/* ===== データ ===== */
const gojuonTable = [
  ["あ","い","う","え","お"],
  ["か","き","く","け","こ"],
  ["さ","し","す","せ","そ"],
  ["た","ち","つ","て","と"],
  ["な","に","ぬ","ね","の"],
  ["は","ひ","ふ","へ","ほ"],
  ["ま","み","む","め","も"],
  ["や","","ゆ","","よ"],
  ["ら","り","る","れ","ろ"],
  ["わ","を","ん","ー","？"],
  ["","","","",""],
  ["1","4","7","",""],
  ["2","5","8","0",""],
  ["3","6","9","",""], 
];

const dakutenMap = {
  "か":"が","き":"ぎ","く":"ぐ","け":"げ","こ":"ご",
  "さ":"ざ","し":"じ","す":"ず","せ":"ぜ","そ":"ぞ",
  "た":"だ","ち":"ぢ","つ":"づ","て":"で","と":"ど",
  "は":"ば","ひ":"び","ふ":"ぶ","へ":"べ","ほ":"ぼ"
};

const handakutenMap = {
  "は":"ぱ","ひ":"ぴ","ふ":"ぷ","へ":"ぺ","ほ":"ぽ"
};

const container = document.getElementById("gojuon");
const result = document.getElementById("result");

/* ===== click + touch 共通 ===== */
function bindAction(el, func) {
  el.addEventListener("click", func);
  el.addEventListener("touchstart", e => {
    e.preventDefault();
    func();
  });
}

/* ===== 入力操作 ===== */
function add(char) {
  result.textContent += char;
}

function deleteOne() {
  result.textContent = result.textContent.slice(0, -1);
}

function clearText() {
  result.textContent = "";
}

function addDakuten() {
  const text = result.textContent;
  if (!text) return;
  const last = text.slice(-1);
  if (dakutenMap[last]) {
    result.textContent = text.slice(0, -1) + dakutenMap[last];
  }
}

function addHandakuten() {
  const text = result.textContent;
  if (!text) return;
  const last = text.slice(-1);
  if (handakutenMap[last]) {
    result.textContent = text.slice(0, -1) + handakutenMap[last];
  }
}

/* ===== 五十音表生成 ===== */
gojuonTable.forEach(row => {
  row.forEach(char => {
    const btn = document.createElement("button");
    btn.textContent = char;

    if (char === "") {
      btn.classList.add("empty");
      btn.disabled = true;
    } else {
      bindAction(btn, () => add(char));
    }
    container.appendChild(btn);
  });
});

/* ===== 操作ボタン ===== */
bindAction(document.getElementById("del"), deleteOne);
bindAction(document.getElementById("clear"), clearText);

document.querySelectorAll("[data-char]").forEach(btn => {
  const char = btn.dataset.char;
  if (char === "゛") bindAction(btn, addDakuten);
  else if (char === "゜") bindAction(btn, addHandakuten);
  else bindAction(btn, () => add(char));
});
</script>

</body>
</html>
